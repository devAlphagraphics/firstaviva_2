var pageName=getCurentPageName();var isMobile=(navigator.userAgent.match(/Android|iPhone|iPad/i)===null)?false:true;var headerHeight=99,footerHeight=595,contentMinHeight=640,popWinTextHeight=0;var TestScore={q1:[20,40,60,50],q2:[10,20,40,40]};var i=0,j=0;var FormData={name:"",sex:"",mobile:"",tel:"",email:"",tnc:0};var TestAns={q1:0,q2:0,score:0};var TryCal={year:0,sex:"",age:0,quota:0,result_period_1:"",result_period_2:"",result_pay_month:0,result_pay_year:0};var Today=new Date();$(window).on("beforeunload",function(){$(window).scrollTop(0)});$(function(){$("body").addClass(pageName);$("#Header #Nav .bu").on("click",function(){switch($(this).attr("id")){case"BU_Product":popMenuHandler("show");break;case"BU_Form":$("html,body").animate({scrollTop:$("#Form").offset().top-headerHeight},800);break;case"BU_Home":window.location.href="index.html";break;case"Logo":window.open("http://www.first-aviva.com.tw/","_blank");break}});$("#Mask #Win_Menu .bu").on("click",function(){window.location.href=$(this).data("link")+".html"});$("#Mask #Win_Menu #BU_BackMenu").on("click",function(){popMenuHandler("hidden")});popWinTextHeight=Math.ceil($("#Mask #Win_TnC").height()*0.85-$("#Mask #Win_TnC .title").height()-toNumber($("#Mask #Win_TnC .title").css("padding-top"))-toNumber($("#Mask #Win_TnC .title").css("padding-bottom")));$("#Mask .popWin .text").css("height",(popWinTextHeight-130)+"px");$("#Mask #Win_TnC .text").css("height",(popWinTextHeight-80)+"px");$("#Mask .popWin .bu_close, #Mask .popWin #BU_Close").on("click",function(){popWinHandler("","hidden")});$("#Form #BU_TnC").on("click",function(){if($(this).hasClass("select")){FormData.tnc=0;$(this).removeClass("select")}else{FormData.tnc=1;$(this).addClass("select")}});$("#Form #BU_TnC_Pop").on("click",function(){popWinHandler("Win_TnC","show")});$("#Form #BU_Submit").on("click",function(){if($.trim($("#Form #FName").val())===""||typeof $("#Form input[name=FSex]:checked").val()==="undefined"||($.trim($("#Form #FMobile").val()))===""){alert("姓名/性別/手機欄位為必填!!\r\n請檢查看看是否有欄位沒有資料.")}else{var a=1;if(a===1){if(ValidateTC($.trim($("#Form #FName").val()))===false){a=0;alert("姓名只能輸入中文, 請檢查輸入的姓名資料!")}}if(a===1){if(($.trim($("#Form #FMobile").val()).length<10)){a=0;alert("手機資料輸入錯誤, 請檢查輸入的資料!")}}if(a===1){if(ValidateMobile($.trim($("#Form #FMobile").val()))===false){a=0;alert("手機資料格式錯誤, 請檢查輸入的手機資料!")}}if(a===1&&($.trim($("#Form #FTel_1").val()).length>0)||($.trim($("#Form #FTel_2").val()).length>0)){if(($.trim($("#Form #FTel_1").val()).length<=1)||($.trim($("#Form #FTel_2").val()).length<=5)){a=0;alert("市話資料輸入錯誤, 請檢查輸入的資料!")}}if(a===1&&($.trim($("#Form #FTel_1").val()).length>0)||($.trim($("#Form #FTel_2").val()).length>0)){if(ValidateTel($.trim($("#Form #FTel_1").val())+"-"+$.trim($("#Form #FTel_2").val()))===false){a=0;alert("市話資料格式錯誤, 請檢查輸入的市話資料!")}}if(a===1&&$.trim($("#Form #FEmail").val()).length>0){if(ValidateEmail($.trim($("#Form #FEmail").val()))===false){a=0;alert("Email資料格式錯誤, 請檢查輸入的Email資料!")}}if(a===1){if(FormData.tnc===0){a=0;alert("請同意 第一金人壽 蒐集、處理及利用個人資料訊息告知事項，並願意讓服務人員致電說明產品資訊。")}}if(a===1){FormData.name=$.trim($("#Form #FName").val());FormData.sex=$("#Try input[name=FSex]:checked").val();FormData.mobile=$.trim($("#Form #FMobile").val());FormData.tel=$.trim($("#Form #FTel_1").val())+"-"+$.trim($("#Form #FTel_2").val());FormData.email=$.trim($("#Form #FEmail").val());window.location.href="index_4.html"}}});switch(pageName){case"index_4":$("#Thank #BU_BackHome").on("click",function(){window.location.href="index.html"});break;case"index":$("#Home #BU_StartTest").on("click",function(){$("#Test input[name=TestAns]").prop("checked",false);$("#Home").fadeOut("fast",function(){$("#Test").fadeIn("fast")})});$("#Test #BU_Answer").on("click",function(){if($("#Test").is(":visible")){if($("#Test").hasClass("q1")){if(typeof $("#Test input[name=TestAns]:checked").val()!="undefined"){TestAns.q1=$("#Test input[name=TestAns]:checked").val();$("#Test").fadeOut("fast",function(){$("#Test input[name=TestAns]").prop("checked",false);$("#Test").removeClass("q1").addClass("q2").fadeIn("fast")})}else{alert("請選擇慶功會在哪裡舉辦?")}}if($("#Test").hasClass("q2")){if(typeof $("#Test input[name=TestAns]:checked").val()!="undefined"){TestAns.q2=$("#Test input[name=TestAns]:checked").val();TestAns.score=TestScore.q1[TestAns.q1-1]+TestScore.q2[TestAns.q2-1];$("#Test").fadeOut("fast",function(){$("#FixdItem").hide();$("#Result").addClass("r"+TestAns.score).fadeIn("fast")})}else{alert("請選擇參加重要考試, 那種狀況你最害怕?")}}}});$("#Result #BU_More, #Result #BU_FBShare").on("click",function(){switch($(this).attr("id")){case"BU_More":switch(toNumber(TestAns.score)){case 30:case 50:case 70:case 90:window.location.href="index_1.html";break;case 40:case 60:case 80:case 100:window.location.href="index_2.html";break}break;case"BU_FBShare":break}});break;default:$("#FixdItem .menu li").on("click",function(){$("#FixdItem .menu li").removeClass("select");$(this).addClass("select");$("#DivContent .container > .page").hide();$("#DivContent #"+$(this).data("go")).fadeIn("fast");if($(this).data("go")==="Intro"){$("#DivContent #"+$(this).data("go")+" .intro").jScrollPane()}if($(this).data("go")==="Example"){$("#Example #Content #E1 .data .text").jScrollPane()}if($(this).data("go")==="Try"){if(pageName==="index_1"||pageName==="index_2"){$("#Try .step1 input[name=TYear]").prop("checked",false)}$("#Try .step1 input[name=TSex]").prop("checked",false);$("#Try #TAge").val("");$("#Try #TQuota").val("");$("#Try .step1").show();$("#Try .step2").hide()}});$("#Feature #BU_Feature_Note").on("click",function(){popWinHandler("Win_Feature","show")});$("#Intro #BU_Intro_Note").on("click",function(){popWinHandler("Win_Intro","show")});$("#Example #Content > div .item").on("click",function(){$("#Example #Content > div").removeClass("open");$(this).parent().addClass("open");$("html,body").animate({scrollTop:$("#"+$(this).parent().attr("id")+"").offset().top-headerHeight},800)});if(pageName==="index_1"){$('#Try input[name="TYear"]:radio').on("click",function(){$("#Try #TAge").empty().append('<option value="">請選擇</option>');if(toNumber($(this).val())===15){for(i=20;i<=60;i++){$("#Try #TAge").append('<option value="'+i+'">'+i+"</option>")}}else{for(i=20;i<=55;i++){$("#Try #TAge").append('<option value="'+i+'">'+i+"</option>")}}})}else{if(pageName==="index_2"){for(i=20;i<=49;i++){$("#Try #TAge").append('<option value="'+i+'">'+i+"</option>")}}else{if(pageName==="index_3"){for(i=45;i<=70;i++){$("#Try #TAge").append('<option value="'+i+'">'+i+"</option>")}$("#Try #TAge").on("change",function(){$("#Try #TQuota").empty().append('<option value="">請選擇</option>');if(toNumber($(this).val())<=65){for(i=30;i<=100;i=i+5){$("#Try #TQuota").append('<option value="'+i+'萬">'+i+"  萬元</option>")}}else{for(i=30;i<=50;i=i+5){$("#Try #TQuota").append('<option value="'+i+'萬">'+i+"  萬元</option>")}}})}}}$("#Try #BU_Cal").on("click",function(){if(typeof $("#Try input[name=TYear]:checked").val()==="undefined"||typeof $("#Try input[name=TSex]:checked").val()==="undefined"||$("#Try #TAge").val()===""||$("#Try #TQuota").val()===""){alert("所有欄位皆為必選!!\r\n請檢查看看是否有欄位沒有選擇資料.")}else{TryCal.year=$("#Try input[name=TYear]:checked").val();TryCal.sex=$("#Try input[name=TSex]:checked").val();TryCal.age=$("#Try #TAge").val();TryCal.quota=$("#Try #TQuota").val();calResult();$("#Try .step1").fadeOut("fast",function(){$("#Try .step2 #DAge").empty().append(TryCal.age+" 歲");if(TryCal.sex==="M"){$("#Try .step2 #DSex").empty().append("男")}else{$("#Try .step2 #DSex").empty().append("女")}$("#Try .step2 #DPeriod").empty().append(TryCal.result_period_1+" ~ "+TryCal.result_period_2);$("#Try .step2 #DQuota").empty().append(TryCal.quota+" 元");$("#Try .step2 #DPay_Month").empty().append(TryCal.result_pay_month+" 元");$("#Try .step2 #DPay_Year").empty().append(TryCal.result_pay_year+" 元");$("#Try .step2").fadeIn("fast")})}});break}});function calResult(){TryCal.result_period_1=Today.getFullYear()+"/"+(Today.getMonth()+1)+"/"+Today.getDate();TryCal.result_period_2=(toNumber(Today.getFullYear())+20)+"/"+(Today.getMonth()+1)+"/"+Today.getDate();switch(pageName){case"index_1":break;case"index_2":break;case"index_3":break}}function popMenuHandler(a){if(a==="show"){$("#Mask").css("top",headerHeight+"px");$("#Mask > *").hide();$("#Mask").fadeIn("fast");$("#Mask #Win_Menu").show();$("body,html").css("overflow","hidden")}if(a==="hidden"){$("#Mask").css("top","0px");$("#Mask > *").hide();$("#Mask").fadeOut("fast");$("body,html").css("overflow","auto")}}function popWinHandler(b,a){if(a==="show"){$("#Mask > *").hide();$("#Mask").fadeIn("fast");$("#Mask #"+b).show();$("#Mask #"+b+" .text").jScrollPane();$("body,html").css("overflow","hidden")}if(a==="hidden"){$("#Mask > *").hide();$("#Mask").fadeOut("fast");$("body,html").css("overflow","auto")}}function getCurentPageName(){var a=window.location.pathname;var b=a.substring(a.lastIndexOf("/")+1).split(".");if(b[0]===""){b[0]="index"}return b[0]}function toNumber(a){return parseInt(a,10)}function ValidateMobile(a){var c=/^09[0-9]{8}$/;var b=false;if(c.test(a)){b=true}return b}function ValidateTel(a){var c=/^[0-9]{2,3}[-][0-9]{6,8}$/;var b=false;if(c.test(a)){b=true}return b}function ValidateEmail(a){if(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,4})+$/.test(a)){return true}else{return false}}function ValidateTC(c){var a=true;for(var b=0;b<c.length;b++){if(c.charCodeAt(b)<19968||c.charCodeAt(b)>40869){a=false}}return a}function GetIEVersion(){var b=window.navigator.userAgent;var a=b.indexOf("MSIE");if(a>0){return parseInt(b.substring(a+5,b.indexOf(".",a)))}else{if(!!navigator.userAgent.match(/Trident\/7\./)){return 11}else{return 0}}};